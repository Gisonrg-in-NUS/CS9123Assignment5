<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="page-main-app">
  <template>
    <style include="iron-flex iron-flex-alignment iron-flex-factors iron-positioning" type="text/css">
      :host{}

      app-toolbar {
        background-color: #4285f4;
        color: #fff;
        font-size: 14px;
        font-weight:lighter;
      }

      .container {
        padding: 8px 4px;
      }
    </style>

    <!-- HTML Contents -->
    <app-toolbar>
      <paper-icon-button icon="accessibility"></paper-icon-button>
      <div>Watch: {{repo.watchers_count}}</div>
      <paper-icon-button icon="star" spacer></paper-icon-button>
      <div>Star:{{repo.stargazers_count}}</div>
      <paper-icon-button icon="play-for-work" spacer></paper-icon-button>
      <div>Fork:{{repo.forks_count}}</div>
      <paper-icon-button icon="code" spacer></paper-icon-button>
      <div>Language:{{repo.language}}</div>
    </app-toolbar>

    <div class="container">
      <all-contributions></all-contributions>
    </div>
  </template>
  <script>
    Polymer({

      is: 'page-main-app',

      properties: {
        repo: {
          type: Object,
          observer: '_repoChanged'
        }
      },

      listeners: {},

      ready:function(){},

      attached:function(){},

      _repoChanged: function(repo) {
        var repoOwner = repo.owner.login;
        var repoName = repo.name;
        this._handleAllContributors(repoOwner, repoName);
      },

      _handleAllContributors: function(user, repo) {
        var self = this;
        document.querySelector('github-api-manager').getAllContributors(user, repo).done(function(res) {
          self.$$('all-contributions').data = res;
        }).fail(function(jqXHR, textStatus, errorThrown) {
          alert(errorThrown);
          console.error(errorThrown);
        });
      }

//      myFunctions:function(){}
    });
  </script>
</dom-module>
